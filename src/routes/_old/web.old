<?php
//--- logout ovunque ma ha senso solo se sei dentro --
$middleware= ['web','auth'];
$namespace='XRA\LU\Controllers\Auth';
Route::group(['prefix' => null, 'middleware' => $middleware, 'namespace' => $namespace], function () {
    //Route::post('logout', ['as'=>'logout','uses'=>'LoginController@logout']); // non serve 'guest'
    Route::post('logout', ['as'=>'logout','uses'=>'LoginController@logout']);
    Route::get('logout', ['as'=>'logout','uses'=>'LoginController@logout']);

    //Route::get('authorization',['as'=>'authorization','uses'=>'LoginController@authorization']);
    //Route::post('authorization',['as'=>'authorization','uses'=>'LoginController@authorization']);

});

$middleware=['web','guest'];
    Route::group(['prefix' => null, 'middleware' => $middleware, 'namespace' => $namespace], function () {
    Route::match(array('GET', 'HEAD'), 'register', [
                'as'=>'register'
                ,'uses'=>'RegisterController@showRegistrationForm']);
    Route::post('register', 'RegisterController@register');
    Route::get('login', ['as'=>'login','uses'=>'LoginController@showLoginForm']);
    Route::post('logout', ['as'=>'logout','uses'=>'LoginController@logout']);

    // POST     | password/email         | password.email   | App\Http\Controllers\Auth\ForgotPasswordController@sendResetLinkEmail  | web,guest
    Route::post('password/email', ['as'=>'password.email','uses'=>'ForgotPasswordController@sendResetLinkEmail']);

    Route::get('login/{provider}', 'LoginController@redirectToProvider');
	Route::get('login/{provider}/callback', 'LoginController@handleProviderCallback');

    Route::get('login', ['as'=>'login','uses'=>'LoginController@showLoginForm']);
    Route::post('login', ['as'=>null,'uses'=>'LoginController@login']); // non serve 'as'
    Route::post('logout', ['as'=>'logout','uses'=>'LoginController@logout']); // non serve 'guest'
    Route::post('password/email', ['as'=>'password.email','uses'=>'ForgotPasswordController@sendResetLinkEmail']); // non serve 'guest'

    //Route::get('authorization',['as'=>'authorization','uses'=>'LoginController@authorization']);
    //Route::post('authorization',['as'=>'authorization','uses'=>'LoginController@authorization']);
    Route::match(array('GET', 'HEAD'), 'password/reset', [
                'as'=>'password.request'
                ,'uses'=>'ForgotPasswordController@showLinkRequestForm']);
    Route::post('password/reset', 'ResetPasswordController@reset');
    Route::match(array('GET', 'HEAD'), 'password/reset/{token}', [
                'as'=>'password.reset'
                ,'uses'=>'ResetPasswordController@showResetForm']);

    Route::match(array('GET', 'HEAD'), 'register', [
                'as'=>'register'
                ,'uses'=>'RegisterController@showRegistrationForm']);
    Route::post('register', 'RegisterController@register');

});


$this->routes();
